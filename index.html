# Estructura del proyecto
# ├── generate_chart.py
# ├── index.html
# ├── data.xlsx
# └── .github/workflows/python-app.yml

# 1. Archivo: generate_chart.py
import pandas as pd
import plotly.express as px

# Leer el archivo Excel
data = pd.read_excel('data.xlsx', parse_dates=['A'], dayfirst=True)
data.columns = ['FechaHora', 'Valor']  # Renombrar columnas para facilidad

# Crear el gráfico interactivo
fig = px.line(data, x='FechaHora', y='Valor', 
              title='Gráfico Interactivo',
              labels={'FechaHora': 'Fecha y Hora', 'Valor': 'Valor'},
              hover_data={'FechaHora': '|%d-%m-%Y %H:%M:%S', 'Valor': ':.2f'})

fig.update_layout(
    xaxis_title="Fecha y Hora",
    yaxis_title="Valor",
    hovermode="x unified",
    template="plotly"
)

# Guardar como HTML
fig.write_html('grafico_interactivo.html')

# 2. Archivo: index.html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfico Interactivo</title>
</head>
<body>
    <h1>Gráfico Interactivo</h1>
    <p>El siguiente gráfico muestra los datos de tu archivo:</p>
    <iframe src="grafico_interactivo.html" width="100%" height="600px" frameborder="0"></iframe>
</body>
</html>

# 3. Archivo: data.xlsx
# (Debes subir un archivo Excel con dos columnas: A (FechaHora) y B (Valor).)

# 4. Archivo: .github/workflows/python-app.yml
name: Generate Interactive Chart

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pandas openpyxl plotly

    - name: Run Python script
      run: python generate_chart.py

    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./
